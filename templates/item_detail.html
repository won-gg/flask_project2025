{% extends "index.html" %}

{% block section %}
<link rel="stylesheet" href="../static/item_style.css" />
<main class="detail-page" 
  data-price="{{ price }}" 
  data-fee="{{ fee }}"
  data-trade="{{ trade }}">  

  <div class="detail-grid">
    <section class="detail-media">
      {% if image_path %}
        {% for image in image_path %}
        <img class="detail-img"
          {% if loop.first %}id="detail-img"{% endif %}
          src="{{ url_for('static', filename='images/' + image) }}"
          alt="{{ title }}">
        {% endfor %}
      {% endif %}
      <button class="arrow prev-btn" id="prev-btn" aria-label="이전">‹</button>
      <button class="arrow next-btn" id="next-btn" aria-label="다음">›</button>
      <div class="pager" id="pager">1 / {{ image_list|length }}</div>
      <div id="image-list" data-images='{{ image_list|tojson}}'></div>
    </section>

    <aside class="detail-info">
      <a href="{{ url_for('view_list') }}#{{ category }}">
      <div class="category">{{ category }} &gt;</div>
      </a>
      <h1 class="title">{{ title }}</h1>
      <div class="price" id="mainPrice" data-price="{{ price }}"></div>
      <div class="trade">
        <span class="dliv {{ 'on' if trade == 'direct' else '' }}">직거래</span>
        <span class="or">/</span>
        <span class="dliv {{ 'on' if trade == 'delivery' else '' }}">택배 거래</span>
        <div class="fee-extra" id="feeExtra"></div>
      </div>
      
      <div class="seller-card">
        <div class="seller-row">
          <div class="seller-info">
            <div class="seller" aria-hidden="true"></div>
            <div class="seller-name"><a href="{{ url_for('profile', user_id=seller) }}">{{ seller }}</a></div>
            <div class="grade">{{ seller_manners_grade | default('A+') }}</div>
          </div>
        </div>
        <p class="memo">
          {{ description }}
        </p>
      </div>

      <div class="total">
        <span class="label">총 금액:</span>
        <price id="totalPrice"></price>
        <span class="hint">( <span id="rawPrice"></span> + <span id="rawFee"></span> )</span>
      </div>

      <div class="buttons">
        <!-- 구매하기 || 판매 완료 -->
        <button class="buy-btn" type="button"
        data-item-id="{{ item_id }}" data-sale="{{ sale }}">
        {% if sale == 'Y' %}구매하기
        {% else %}판매 완료
        {% endif %}
        </button>
        <!-- 판매 완료일 때 나타남 -->
        <button class="reg_review-btn" type="button" onclick="location.href='/reg_review_for/{{item_id}}/';"
        style="{% if sale == 'Y' %}display:none;{% endif %}">+ 리뷰 작성하기
        </button>
      </div>
      <!-- 좋아요 수 -->
      <div class="heart-box">
        <i class="fa fa-heart" id="heart"></i>
        <div class="heart-cnt"> {{ heart_cnt }}</div>
      </div>

    </aside>
  </div>
</main>
<script src="{{ url_for('static', filename='item_detail.js') }}"></script>

{% endblock section %}