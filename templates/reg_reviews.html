{% extends "index.html" %}

{% block section %}
<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¦¬ë·° ì‘ì„± í™”ë©´</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='reg_reviews_style.css')}}">
</head>

<body>
  <main>
    <form action="/reg_review_post" method="post" enctype="multipart/form-data">
  
    <header class = "header">
      <h1 class = "title">ë¦¬ë·° ì‘ì„±</h1>
      <p class = "description">êµ¬ë§¤í•˜ì‹  ìƒí’ˆì— ëŒ€í•œ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”</p>
    </header>

    <!--êµ¬ë§¤ ìƒí’ˆ ì •ë³´-->
    <section class = "container">
      <h2 class = "heading">êµ¬ë§¤ ìƒí’ˆ *</h2>
      <div class = "input">
        <div class = "item_box">
          <div>ìƒí’ˆëª…: {{ item_name | default('ìƒí’ˆëª… ì—†ìŒ') }}</div>
        </div>
      </div>
    </section>

    <!--ìˆ¨ê²¨ì§„ ì…ë ¥ í•„ë“œë¡œ, ìƒí’ˆ ì•„ì´ë””ì™€ ì´ë¦„ì„ DBë¡œ ì „ì†¡í•˜ê¸° ìœ„í•´-->
    <input type="hidden" name="item_id" value="{{ item_id | default('') }}">
    <input type="hidden" name="item_name" value="{{ item_name | default('') }}">

    <!--ìƒí’ˆ í‰ê°€(ë§¤ë„ˆ í•™ì )-->
    <section class = "container">
      <h2 class = "heading">ìƒí’ˆ í‰ê°€ *</h2>
      <p class = "description small">- ì™€ + ë²„íŠ¼ì„ ëˆŒëŸ¬ ë§¤ë„ˆ í•™ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”</p>

      <div class = "rating_box">
        <button class = "circle_btn" type = "button">âˆ’</button>
        <div class = "rating_grade">A+</div>
        <button class = "circle_btn" type = "button">ï¼‹</button>
      </div>

      <!--ìˆ¨ê²¨ì§„ ì…ë ¥ í•„ë“œë¡œ, ë§¤ë„ˆ í•™ì ì„ DBë¡œ ì „ì†¡í•˜ê¸° ìœ„í•´-->
      <input type = "hidden" id = "rating_input" name  ="rating_input" value = "A+">

    </section>


    <!--ë¦¬ë·° ë‚´ìš©-->
    <section class = "container">
      <h2 class = "heading">ë¦¬ë·° ë‚´ìš©</h2>

      <div class = "input">
        <label class = "label" for="review_title">ë¦¬ë·° ì œëª© *</label>
        <input class = "input_box" type="text" name="review_title" id="review_title" placeholder = "ë¦¬ë·° ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
      </div>

      <div class = "input">
        <label class = "label" for="content">ë¦¬ë·° ë‚´ìš© *</label>
        <textarea class = "input_box" id = "content" name = "content" placeholder = "ìƒí’ˆì— ëŒ€í•œ ì†”ì§í•œ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš” &#10;&#10;ì˜ˆì‹œ:&#10;- ìƒí’ˆì˜ ì¥ì ê³¼ ë‹¨ì &#10;- ì‹¤ì œ ì‚¬ìš© í›„ê¸°&#10;- ë‹¤ë¥¸ êµ¬ë§¤ìë“¤ì—ê²Œë„ ë„ì›€ì´ ë  ì •ë³´" required></textarea>
      </div>
    </section>

    <!--ë¦¬ë·° ì‚¬ì§„-->
    <section class = "container">
      <h2 class = "heading">ë¦¬ë·° ì‚¬ì§„ *</h2>
      <p class = "description small">ì‹¤ì œ ì‚¬ìš© ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì‹œë©´ ë”ìš± ìœ ìš©í•œ ë¦¬ë·°ê°€ ë©ë‹ˆë‹¤ (ìµœëŒ€ 5ì¥)</p>


      <div class = img_upload_box>
        <div class="img_preview" id="imagePreview"></div>
        <div class = "img_upload">
          <!--ì‹¤ì œ íŒŒì¼ ì…ë ¥ ë²„íŠ¼ì€ ìˆ¨ê¹€ ì²˜ë¦¬-->
          <input type="file" id = "file" name="file" multiple hidden required/>
          <!--ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ëŠ” ë²„íŠ¼-->
          <label for="file" class = "upload_btn">
            <div class = "icon">ğŸ“·</div>
            <div class = "description small">ì‚¬ì§„ ì¶”ê°€</div>
          </label>
        </div>
      </div>
    </section>

    <!--ì‘ì„±ì ì •ë³´-->
    <section class = "container">
      <h2 class = "heading">ì‘ì„±ì ì •ë³´</h2>

      <div class = "input">
        <label class = "label" for="id">ì•„ì´ë”” *</label>
        <input class = "input_box" type="text" id="id_display" value="{{ reviewer_id | default('') }}" readonly>
      </div>
      <input type="hidden" name="id" id="id" value="{{ reviewer_id | default('') }}">
    </section>

    <section class = "container">
      <label class="checkbox">
        <input type="checkbox" required>
        ë¦¬ë·° ì‘ì„± ì‹œ ì»¤ë®¤ë‹ˆí‹° ê°€ì´ë“œë¥¼ ì¤€ìˆ˜í•˜ë©°, í—ˆìœ„ ë˜ëŠ” ê³¼ì¥ëœ ë‚´ìš©ì´ í¬í•¨ë˜ì§€ ì•Šì•˜ìŒì„ í™•ì¸í•©ë‹ˆë‹¤. *
      </label>
    </section>


    <div class = "btn">
      <input type="submit" value="ë¦¬ë·° ë“±ë¡í•˜ê¸°">
      <input type="reset" value="ì·¨ì†Œ">
    </div>

    </form>
  </main>

  <script>
    const gradeDisplay = document.querySelector(".rating_grade");
    const plusBtn = document.querySelectorAll(".circle_btn")[1];
    const minusBtn = document.querySelectorAll(".circle_btn")[0];
    const ratingInput = document.getElementById("rating_input");

    // ë“±ê¸‰ ë¦¬ìŠ¤íŠ¸ (A+ â†’ F)
    const grades = ["A+", "A", "A-", "B+", "B", "B-", "C+", "C", "C-", "D+", "D", "D-", "F"];
    let currentIndex = 0; // A+ë¶€í„° ì‹œì‘

    function updateGrade() {
      const currentGrade = grades[currentIndex];
      gradeDisplay.textContent = currentGrade;
      ratingInput.value = currentGrade;

      // A+ì´ë©´ + ë¹„í™œì„±í™”, Fì´ë©´ - ë¹„í™œì„±í™”
      plusBtn.disabled = currentIndex === 0;
      minusBtn.disabled = currentIndex === grades.length - 1;

      // ë¹„í™œì„±í™” ìƒíƒœì¼ ë• íë¦¬ê²Œ
      plusBtn.style.opacity = plusBtn.disabled ? "0.4" : "1";
      minusBtn.style.opacity = minusBtn.disabled ? "0.4" : "1";
    }

    plusBtn.addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        updateGrade();
      }
    });

    minusBtn.addEventListener("click", () => {
      if (currentIndex < grades.length - 1) {
        currentIndex++;
        updateGrade();
      }
    });

    updateGrade(); 
  </script>

  <script>
  let selectedFiles = [];

  document.getElementById('file').addEventListener('change', function(e) {
    var preview = document.getElementById('imagePreview');
    var newFiles = Array.from(e.target.files);
    
    if (selectedFiles.length + newFiles.length > 5) {
      alert("ì‚¬ì§„ì€ ìµœëŒ€ 5ì¥ê¹Œì§€ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤. í˜„ì¬ " + selectedFiles.length + "ì¥ ì„ íƒë¨.");
      e.target.value = "";
      return;
    }
    
    selectedFiles = selectedFiles.concat(newFiles);
    
    preview.innerHTML = "";
    
    selectedFiles.forEach(function(file) {
      var reader = new FileReader();
      
      reader.onload = function(event) {
        var img = document.createElement("img");
        img.src = event.target.result;
        preview.appendChild(img);
      };
      
      reader.readAsDataURL(file);
    });
    

    var dataTransfer = new DataTransfer();
    selectedFiles.forEach(function(file) {
      dataTransfer.items.add(file);
    });
    e.target.files = dataTransfer.files;
  });
  </script>

</body>


{% endblock section %}